---
import Layout from '../../layouts/Layout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map((article) => ({
    params: { slug: article.slug },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content } = await render(article);

// Format date
const formattedDate = article.data.date.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<Layout
  title={`${article.data.title} - Approachable Design`}
  description={article.data.description}
  ogImage={article.data.image}
  variant="light"
  article={{ publishedDate: article.data.date }}
>
  <article class="py-16 md:py-24">
    <div class="container">
      <div class="max-w-3xl mx-auto">
        <!-- Header -->
        <header class="mb-12">
          {article.data.category && (
            <span class="text-brand-purple text-sm font-medium uppercase tracking-wider">
              {article.data.category.replace('-', ' ')}
            </span>
          )}
          <h1 class="font-display text-3xl md:text-5xl font-bold mt-4 mb-6 text-brand-dark">
            {article.data.title}
          </h1>
          <p class="text-brand-dark/60">
            {formattedDate}
          </p>
        </header>

        <!-- Featured Image -->
        {article.data.image && (
          <img
            src={article.data.image}
            alt={article.data.title}
            class="w-full rounded-2xl mb-12"
          />
        )}

        <!-- Content -->
        <div class="prose prose-light">
          <Content />
        </div>

        <!-- Back link -->
        <div class="mt-16 pt-8 border-t border-brand-dark/10">
          <a href="/articles" class="text-brand-purple hover:underline">
            &larr; Back to all articles
          </a>
        </div>
      </div>
    </div>
  </article>
</Layout>

<style>
  .prose-light {
    color: #0B0A16;
  }
  .prose-light :global(p) {
    color: rgba(11, 10, 22, 0.8);
  }
  .prose-light :global(strong) {
    color: #0B0A16;
  }
  .prose-light :global(h1),
  .prose-light :global(h2),
  .prose-light :global(h3) {
    color: #0B0A16;
  }
  .prose-light :global(ul li),
  .prose-light :global(ol li) {
    color: rgba(11, 10, 22, 0.8);
  }
  .prose-light :global(a) {
    color: #5148CA;
  }
  .prose-light :global(blockquote) {
    color: rgba(11, 10, 22, 0.7);
    border-left-color: #5148CA;
  }
</style>
